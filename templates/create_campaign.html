{% extends 'base.html' %}
{% block title %}Create Facebook Campaign{% endblock %}
{% block content %}
<div class="py-4">
	<div class="form-container">
		<div class="header-section mb-4">
			<h2 class="page-title">
				<i class="fab fa-facebook text-primary me-2"></i>Create Facebook Campaign
			</h2>
			<p class="text-muted">Fill in the details below to create a new Facebook campaign</p>
		</div>

		<form method="POST" action="{{ url_for('ads_manager.create_fb_campaign') }}" class="needs-validation" novalidate>
			{{ form.csrf_token }}

			<!-- Account Selection Section -->
			<div class="card mb-4 form-section">
				<div class="card-header bg-light">
					<h5 class="mb-0">
						<i class="fas fa-user-circle me-2"></i>Account Information
					</h5>
				</div>
				<div class="card-body">
					<div class="mb-3">
						<label for="ad_account_id" class="form-label fw-bold">
							<i class="fas fa-building me-2"></i>Select Ad Account
						</label>
						<select class="form-select custom-select" id="ad_account_id" name="ad_account_id" required>
							<option value="" disabled selected>Select an ad account</option>
							{% for ad_account in ad_accounts %}
							<option value="{{ ad_account.facebook_ad_account_id }}"
								{% if ad_account.facebook_ad_account_id == form.ad_account_id.data %}selected{% endif %}>
								{{ ad_account.name }}
							</option>
							{% endfor %}
						</select>
					</div>

					<div class="mb-3">
						<label for="campaign_name" class="form-label fw-bold">
							<i class="fas fa-tag me-2"></i>Campaign Name
						</label>
						{{ form.campaign_name(class="form-control", id="campaign_name", placeholder="Enter campaign name") }}
					</div>
				</div>
			</div>

			<!-- Campaign Details Section -->
			<div class="card mb-4 form-section">
				<div class="card-header bg-light">
					<h5 class="mb-0">
						<i class="fas fa-cogs me-2"></i>Campaign Settings
					</h5>
				</div>
				<div class="card-body">
					<div class="mb-3">
						<label for="objective" class="form-label fw-bold">
							<i class="fas fa-bullseye me-2"></i>Objective
						</label>
						{{ form.objective(class="form-select custom-select", id="objective") }}
					</div>

					<div class="mb-3">
						<label for="status" class="form-label fw-bold">
							<i class="fas fa-toggle-on me-2"></i>Status
						</label>
						{{ form.status(class="form-select custom-select", id="status") }}
					</div>

					<div class="row mb-3">
						<div class="col-md-6">
							<label for="start_time" class="form-label fw-bold">
								<i class="fas fa-calendar-plus me-2"></i>Start Time
							</label>
							<input type="datetime-local" class="form-control" id="start_time" name="start_time"
								value="{{ form.start_time.data|datetimeformat('%Y-%m-%dT%H:%M') }}" required>
						</div>
						<div class="col-md-6">
							<label for="end_time" class="form-label fw-bold">
								<i class="fas fa-calendar-minus me-2"></i>End Time
							</label>
							<input type="datetime-local" class="form-control" id="end_time" name="end_time"
								value="{{ form.end_time.data|datetimeformat('%Y-%m-%dT%H:%M') }}" required>
						</div>
					</div>

					<div class="mb-3">
						<label for="special_ad_categories" class="form-label fw-bold">
							<i class="fas fa-star me-2"></i>Special Ad Categories
						</label>
						<select class="form-select custom-select" id="special_ad_categories" name="special_ad_categories" required>
							<option value="NONE" {% if form.special_ad_categories.data == 'NONE' %}selected{% endif %}>None</option>
							<option value="HOUSING" {% if form.special_ad_categories.data == 'HOUSING' %}selected{% endif %}>Housing
							</option>
							<option value="EMPLOYMENT" {% if form.special_ad_categories.data == 'EMPLOYMENT' %}selected{% endif %}>
								Employment</option>
							<option value="CREDIT" {% if form.special_ad_categories.data == 'CREDIT' %}selected{% endif %}>Credit
							</option>
						</select>
					</div>
				</div>
			</div>

			<div class="text-end">
				<button type="button" class="btn btn-secondary me-2" onclick="history.back()">
					<i class="fas fa-times me-2"></i>Cancel
				</button>
				<button type="submit" class="btn btn-primary">
					<i class="fas fa-check me-2"></i>Create Campaign
				</button>
			</div>
		</form>
	</div>
</div>

<style>
	.form-container {
		max-width: 900px;
		margin: 0 auto;
	}

	.page-title {
		color: #2c3e50;
		border-bottom: 3px solid #007bff;
		padding-bottom: 10px;
		margin-bottom: 10px;
	}

	.form-section {
		border: 1px solid #e9ecef;
		border-radius: 8px;
		transition: all 0.3s ease;
	}

	.form-section:hover {
		box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
	}

	.card-header {
		border-bottom: 1px solid #e9ecef;
		background-color: #f8f9fa !important;
	}

	.form-label {
		color: #495057;
	}

	.form-control,
	.form-select {
		border: 1px solid #ced4da;
		border-radius: 6px;
		padding: 0.625rem 0.75rem;
		transition: all 0.2s ease;
	}

	.form-control:focus,
	.form-select:focus {
		border-color: #007bff;
		box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
	}

	.custom-select {
		background-color: #fff;
		cursor: pointer;
	}

	.btn {
		padding: 0.625rem 1.25rem;
		font-weight: 500;
		border-radius: 6px;
		transition: all 0.3s ease;
	}

	.btn-primary {
		background-color: #007bff;
		border-color: #007bff;
	}

	.btn-primary:hover {
		background-color: #0056b3;
		border-color: #0056b3;
		transform: translateY(-1px);
	}

	.btn-secondary {
		background-color: #6c757d;
		border-color: #6c757d;
	}

	.btn-secondary:hover {
		background-color: #5a6268;
		border-color: #545b62;
	}

	/* Responsive adjustments */
	@media (max-width: 768px) {
		.form-container {
			padding: 15px;
		}

		.card-body {
			padding: 1rem;
		}

		.btn {
			width: 100%;
			margin-bottom: 0.5rem;
		}

		.text-end {
			text-align: center !important;
		}
	}
</style>

<script>
	// Form validation
	(function () {
		'use strict'
		var forms = document.querySelectorAll('.needs-validation')
		Array.prototype.slice.call(forms).forEach(function (form) {
			form.addEventListener('submit', function (event) {
				if (!form.checkValidity()) {
					event.preventDefault()
					event.stopPropagation()
				}
				form.classList.add('was-validated')
			}, false)
		})
	})()

	// Initialize datetime inputs with current time
	document.addEventListener('DOMContentLoaded', function () {
		if (!document.getElementById('start_time').value) {
			const now = new Date();
			const nowFormatted = now.toISOString().slice(0, 16);
			document.getElementById('start_time').value = nowFormatted;
		}
	});
</script>
{% endblock %}